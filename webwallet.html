<!DOCTYPE html>
<html>
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <title>Duino-Coin Web Wallet</title>
      <!-- SEO Stuff -->
      <meta name="description" content="Duino-Coin Web Wallet">
      <meta name="keywords" content="wallet, webwallet, duinocoin, duco, duco webwallet">
      <link rel="canonical" href="http://51.15.127.80/webwallet.html" />
      <meta name="robots" content="index, follow">
      <meta name="theme-color" content="#D90088">
      <!-- Open Graph Metadata -->
      <meta property="og:site_name" content="Duino-Coin Web Wallet" />
      <meta property="og:site" content="http://51.15.127.80/webwallet.html" />
      <meta property="og:title" content="Duino-Coin Web Wallet"/>
      <meta property="og:description" content="Duino-Coin Web Wallet" /> 
      <meta property="og:image" content="https://github.com/revoxhere/duino-coin/blob/master/Resources/NewWallet.ico?raw=true" />
      <meta property="og:url" content="http://51.15.127.80/webwallet.html" />
      <meta property="og:type" content="website" />   
      <!-- Twitter Metadata -->
      <meta name="twitter:title" content="Duino-Coin Web Wallet">
      <meta name="twitter:description" content="Duino-Coin Web Wallet">
      <meta name="twitter:image" content="https://github.com/revoxhere/duino-coin/blob/master/Resources/NewWallet.ico?raw=true">
      <meta name="twitter:site" content="@CoinDuino">
      <meta name="twitter:creator" content="@CoinDuino">
      <!-- Linked content -->
      <link rel="icon" href="https://github.com/revoxhere/duino-coin/blob/master/Resources/NewWallet.ico?raw=true" type="image/png"/>
      <link rel="shortcut icon" href="https://github.com/revoxhere/duino-coin/blob/master/Resources/NewWallet.ico?raw=true" type="image/png"/>
      <link rel="stylesheet" href="bulma.min.css">
      <link rel="preconnect" href="https://fonts.gstatic.com">
      <link href="https://fonts.googleapis.com/css2?family=Open+Sans+Condensed:wght@300&family=Quicksand&display=swap" rel="stylesheet">
      <script defer src="all.js"></script>
      <script src="jquery.min.js"></script>
      <style>
      * {
        font-family: 'Quicksand', sans-serif;
        text-shadow: 1px 1px 7px #000000;
      }
        body {
          background: url("bckg.jpg") no-repeat;
          background-size: cover;
          background-attachment: fixed;
        }
        h1, h2, h3, h4, h5, h6, p, label, div {
          color: white !important;
        }
        a {
          color: #2c3e50 !important;
        }
        ::placeholder {
          color: #FAFAFA !important;
          opacity: 1;
        }
        input {
          background-color: none !important;
          color: white !important;
          border-style: none !important;
        }
        .custButton {
          border-style: none !important;
          color: white !important;
        }
        .container21 {
          box-shadow: 0 0 1rem 0 rgba(0, 0, 0, .2);   
          border-radius: 6px;
          border-top: 100px;
          padding: 1em;
          background-color: rgba(0, 0, 0, .2);
            
          backdrop-filter: blur(5px);
          -moz-filter: blur(5px);
          -o-filter: blur(5px);
          -ms-filter: blur(5px);
        }
        #cover {position: fixed; height: 100%; width: 100%; top:0; left: 0; background: #FFFFFF; z-index:9999;}
      </style>
      <script>
        $(window).on('load', function() {
           $("#cover").hide();
        });
        window.onload = function(){
          var speed = "normal";
          $("html, body").hide();
          $(document).ready(function() {
              $("html, body").fadeIn(speed, function() {
                  $("a[href], button[href]").click(function(event) {
                      var url = $(this).attr("href");
                      if (url.indexOf("#") == 0 || url.indexOf("javascript:") == 0) return;
                      event.preventDefault();
                      $("html, body").fadeOut(speed, function() {
                          window.location = url;
                      });
                  });
              });
          });
          let message;
          let version_received = 0;
          let sendinfo;
          var ducoprice;
          var oldbalance = 0;
          let ws = new WebSocket("ws://51.15.127.80:15808");
          let login = document.querySelector(".login");
          let loginInput = document.querySelector(".loginInput");
          let send = document.querySelector(".send");

          n =  new Date();
          y = n.getFullYear();
          m = n.getMonth() + 1;
          d = n.getDate();
          document.getElementById("date").innerHTML = "<img height='16em' width='16em' src='https://github.com/revoxhere/duino-coin/blob/master/Resources/NewWallet.ico?raw=true'>&nbsp;DUCO WebWallet (v1.7) " + d + "/" + m + "/" + y;

          $.getJSON("https://raw.githubusercontent.com/revoxhere/duco-statistics/master/api.json", function(data) {
                ducoprice = `${data["Duco price"]}`
                var cutducoprice = 1 * ducoprice;
                cutducoprice = cutducoprice.toFixed(6);
                document.getElementById("ducoprice").innerHTML = cutducoprice + " USD";
            });

           document.getElementById("recipientInput").style.display="none";
           document.getElementById("amountInput").style.display="none";
           document.getElementById("sendInput").style.display="none";
           document.getElementById("balancetext").style.display="none";
           document.getElementById("mainsection").style.display="none";
         
           ws.onmessage = function (event) {
             let server_message = event.data;
             console.log("Server: " + server_message)
         
             if (version_received == 0 && server_message.includes("1.")) {
               document.getElementById("loginstatus").innerHTML = "Proxy server is online";
               version_received = 1;
             }
             else if (server_message == "OK") {
               document.getElementById("loginstatus").innerHTML = "Logged-in successfully!";

               var username = document.getElementById("username").value;
               document.getElementById("welcometext").innerHTML = "Welcome back, " + username + "!";

               $("#usernameInput").fadeOut(500, "linear");
               $("#herosection").fadeOut(500, "linear");
               $("#pwdInput").fadeOut(500, "linear");
               $("#loginInput").fadeOut(500, "linear");

               $("#mainsection").fadeIn(800, "linear");
               $("#welcometext").fadeIn(500, "linear");
               $("#balancetext").fadeIn(1500, "linear");
               $("#recipientInput").fadeIn(1000, "linear");
               $("#amountInput").fadeIn(1000, "linear");
               $("#sendInput").fadeIn(1000, "linear");

             }
         
             else if (server_message.includes("NO")) {
               document.getElementById("loginstatus").innerHTML = "Error logging-in, refresh the page and try again";
               if (confirm("Error logging-in, refresh the page to try again?")) {
                 location.reload();
               }
             }
         
             else if (version_received == 1 && server_message.includes(".")) {
                  balanceusd = ducoprice * server_message;
                  balanceusd = balanceusd.toFixed(4);
                  
                  cutbalance = server_message * 1;
                  cutbalance = cutbalance.toFixed(6);

                  difference = cutbalance - oldbalance;
                  difference = difference.toFixed(6);

                  if (difference != 0){
                    oldbalance = cutbalance;
            var today = new Date();
            var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
            document.getElementById("lasttransaction").innerHTML = time + " : " + difference + " DUCO";
            
                  }

               document.getElementById("balancetext").innerHTML = cutbalance + " DUCO";
               document.getElementById("usdbalancetext").innerHTML = balanceusd + " USD";
             }
             else if (sendinfo == 1) {
               document.getElementById("sendstatus").innerHTML = "Server message: " + server_message;
               sendinfo = 0;
             }
           }
         
           login.onclick = function (event) {
             var username = document.getElementById("username").value;
             var password = document.getElementById("password").value;
             ws.send("LOGI,"+username+","+password);
             window.setInterval(function(){
               ws.send("BALA")}, 750);
           }
         
           send.onclick = function (event) {
             var recipient = document.getElementById("recipient").value;
             var amount = document.getElementById("amount").value;
             ws.send("SEND,-,"+recipient+","+amount);
             sendinfo = 1;
           }
         }
      </script>
   </head>
   <body>
    <div id="cover"></div>
      <section id="herosection" style="height: 100em">
         <div class="hero-body">
               <div class="columns is-centered">
                  <div class="column is-5-tablet is-4-desktop is-30-widescreen">
                     <div class="box container21">
                      <h1 class="title"><img height="25em" width="25em" src="https://github.com/revoxhere/duino-coin/blob/master/Resources/NewWallet.ico?raw=true">&nbsp;Duino-Coin Wallet</h1>
                      <h2 class="subtitle">Login to existing account</h2>
                        <div class="field">
                           <label for="" class="label">Username</label>
                           <div id="usernameInput" class="field">
                              <p class="control has-icons-left">
                                 <input class="container21 input" id="username" type="text" placeholder="Username">
                                 <span class="icon is-small is-left">
                                 <i class="fas fa-user"></i>
                                 </span>
                              </p>
                           </div>
                        </div>
                        <div class="field">
                           <label for="" class="label">Password</label>
                           <div id="pwdInput" class="field">
                              <p class="control has-icons-left">
                                 <input class="input container21" id="password" type="password" placeholder="Password">
                                 <span class="icon is-small is-left">
                                 <i class="fas fa-lock"></i>
                                 </span>
                              </p>
                           </div>
                        </div>
                        <div id="loginInput" class="buttons">
                           <button class="button container21 custButton login">Login</button>
                           <a href="/register.html" class="button container21 custButton">Register</a>
                        </div>
                        <h4 class="subtitle is-7" id="loginstatus">Connecting to proxy</h4>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </section>

      <section class="section" id="mainsection">
        <div class="container">
        <main class="column">
          <div class="level">
            <div class="level-left">
              <div class="level-item">
                <div class="title" id="welcometext"></div>
              </div>
            </div>
            <div class="level-right">
              <div class="level-item">
                <button type="button" id="date" href="https://duinocoin.com" class="button is-small is-disabled container21 custButton"></button>
              </div>
            </div>
          </div>
          
          <div class="columns is-multiline">
            <div class="column">
              <div class="container21">
                <div class="heading">DUCO balance</div>
                <div class="title" id="balancetext"></div>
              </div>
            </div>

            <div class="column">
              <div class="container21">
                <div class="heading">FIAT balance</div>
                <div class="title" id="usdbalancetext"></div>
              </div>
            </div>

            <div class="column">
              <div class="container21">
                <div class="heading">1 DUCO =</div>
                <div class="title" id="ducoprice"></div>
              </div>
            </div>
          </div>

        <div class="columns is-multiline">
            <div class="column">
              <div class="container21">
                <div class="heading">Last local transaction</div>
                <div class="title" id="lasttransaction">No local transactions</div>
              </div>
            </div>
        </div>
       
        <hr>
        <div class="title">Send funds</div>

          <table>
           <tr class="mx-10">
              <div id="recipientInput" class="field">
                 <p class="control has-icons-left has-icons-right">
                    <input class="container21 input" id="recipient" type="text" placeholder="Recipient">
                    <span class="icon is-small is-left">
                    <i class="fas fa-address-book"></i>
                    </span>
                 </p>
              </div>
           </tr>
           <tr>
              <div id="amountInput" class="field">
              <td width="100%">
                <p class="control has-icons-left has-icons-right">
                    <input class="container21 input" id="amount" type="number" placeholder="Amount">
                    <span class="icon is-small is-left"><i class="fas fa-credit-card"></i></span>
                </p>
              </td>
              <td>
                <div id="sendInput" class="buttons">
                <button class="button container21 custButton send">Send funds</button>
                </div>
              </td>
            </div>
           </tr>
          </table>

          <br>
          <div class="subtitle" id="sendstatus"></div>

          <hr>
        <div class="title">Receive funds</div>

        <div class="title-2">To receive funds, instruct others to send DUCO to your username. Successfull transaction will result in immediate money transfer.</div>

        <hr>
        <div class="title">Useful links</div>
        <a href="https://revoxhere.github.io/duco-exchange/" class="button container21 custButton"><i class="fas fa-coins"></i>&nbsp;Official DUCO exchange</a>
        <a href="https://discord.gg/kvBkccy" class="button container21 custButton"><i class="fab fa-discord"></i>&nbsp;Duino-Coin Discord</a>
        <a href="https://github.com/revoxhere/duino-coin" class="button container21 custButton"><i class="fab fa-github"></i>&nbsp;Duino-Coin GitHub</a>
        <a href="/webminer.html" class="button container21 custButton">Duino-Coin Online (Web) Miner</a>

        <hr>
      
      <div class="content has-text-centered">
        <p>Duino-Coin WebWallet made with <i class="fa fa-code"></i>, <i class="fa fa-coffee"></i> and <i class="fa fa-heart"></i> by revox 2020<br>Background photo by u/CampsG from r/EarthPorn</p></p>
      </div>
      </section>
   </body>
</html>

